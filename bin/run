#!/bin/bash -e

: ${WORKDIR:=$PWD}
: ${IMAGE:=trevorj/ubuntu-salt-minion:local}

[[ -z "$MINION_ID" ]] \
    || ARGS+=" -e MINION_ID=$MINION_ID"

#[[ -z "$MINION_ROLE" ]] \
#    || ARGS+=" -e MINION_ROLE=$MINION_ROLE"

exec docker run -t -i \
    -v "${STATES:-$WORKDIR/salt}:/srv/salt" \
    -v "${PILLAR:-$WORKDIR/pillar}:/srv/pillar" \
    $ARGS \
    "$IMAGE" \
    "$@"
